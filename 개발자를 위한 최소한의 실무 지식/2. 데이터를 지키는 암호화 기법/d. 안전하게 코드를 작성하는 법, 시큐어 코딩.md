### 개요
시큐어 코딩이란 해커의 공격도 철통같이 방어하는 안전한 소프트웨어를 개발하기 위해 코드에 보안 약점이 없도록 소프트웨어를 안전하게 설계하고 구현하는 작업이다.  
안전한 소프트웨어를 만들기 위해서 해커들의 공격 패턴을 아는 것이 중요하다.  
- OWASP는 보안이 뚫릴만한 취약점을 연구하는 비영리 재단이다.
  - '웹 어플리케이션'이 유독 보안에 취약한 이유는 웹 서비스용 80 포트가 항상 열려 있어 해커의 공격이 웹 어플리케이션에 집중되기 때문이다.
  - 인젝션, 취약한 인증, 민감한 데이터 노출, XML 외부 개체, 취약한 접근 통제, 잘못된 보안 구성, 크로스 사이트 스크립팅, 안전하지 않은 역직렬화, 알려진 취약점이 있는 구성 요소 사용 그리고 불충분한 로깅과 모니터링

### SQL 인젝션
**클라이언트가 웹 서버로 사용자 요청을 전달하는 과정에서 공격 문자열이 추가되는 것을 말한다.**  
웹 서버는 특정 요청을 처리하기 위해 다음과 같은 문장을 실행한다.  
```sql
SELECT * FROM movies WHERE title = 'iron man';
```
사용자가 입력한 단어 'iron man'이 SQL 문장에 그대로 포함된다는 점이 문제이다.  

🚨 로그인 과정에서 SQL 문장의 실행 등 DBMS 사용은 필수적이다. 해커들은 로그인 화면에서 SQL 인젝션 공격 기법을 활용한다. 그래서 해커들은 로그인 화면에서 SQL 인젝션 기법을 활용한다.
```sql
SELECT * FROM members WHERE id=user_id AND password=user_pw;
/* 위의 SQL에 인젝션을 통해 공격하면 아래와 같은 쿼리가 탄생한다. WHERE의 전체 조건이 모두 참이 되기 때문에 해커는 로그인에 성공하게 된다.*/
SELECT * FROM members WHERE id='user' AND password='or 1=1 --';
```
SQL 인젝션은 사용자가 입력한 값이 데이터베이스 쿼리문에 포함된다면 바로 그 쿼리문이 SQL 인젝션 공격을 받을 수 있다.

이를 해결 하기 위해서, `Prepared Statement`를 사용한 코드를 사용하면 된다.  
`Prepared Statement`란 쿼리문을 미리 컴파일해 실행 계획을 캐시에 적재해놓기 때문에 공격 문자열이 쿼리문의 구조를 바꿀 수 없다.

### OS 명령어 인젝션
OS 명령어는 리눅스의 터미널이나 윈도우의 명령 프롬프트를 이용해 실행하는 운영체제 명령어이다.
```cmd
$ date
$ hostname
$ pwd

$ date ; hostname ; pwd
```
세미 콜론을 활용하면 이미 있는 명령어에 새 명령어를 추가할 수 있다. 이 점을 활용해서 OS 명령어 인젝션을 한다.  
별도의 검증 없이 외부 입력값이 OS 명령어에 포함되는 경우, 보안의 취약점이 발생할 수 있다.
```java
String domain = getParameter("domain");
Process process = Runtime.getRuntime().exec("cmd.exe /c nslookup " + domain);

// 이러한 공격에 대비하기 위해서 명령어 추가를 막으면 된다. 외부에서 입력한 문자열 중 여러 명령어를 이어주는 특수문자를 제거하면 된다.
domain = date.replaceAll("|", "")
domain = date.replaceAll(";", "")
// etc
```

### 크로스 사이트 스크립팅
크로스 사이트 스크립팅(XSS)는 웹 페이지에 스크립트를 삽입하여 웹 브라우저에 악성 코드가 실행되게 하는 공격이다.
1. 해커는 스크립트 삽입 공격에 취약한 웹 사이트를 찾아낸다.
2. 선량한 사용자의 세션 정보를 훔칠 수 있느 스크립트를 게시글로 등록한다.
3. 관심을 끄는 게시글로 인해 사용자는 게시글을 클릭한다.
4. 그 순간 악성 스크립트가 실행되어 사용자의 세션 정보가 해커에게 전달된다.